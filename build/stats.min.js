// @drecom/stats.js - http://github.com/drecom/stats.js
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Stats=t()}(this,function(){"use strict";var e=function(e,t){var n=e,r=1e3/n,o=1e3/n*.6,a=2*Math.round(window.devicePixelRatio||1),f=80*a,i=48*a,l=3*a,u=2*a,c=3*a,d=25*a,m=74*a,s=20*a,p=d/2,h="#002",v="#124",x=0,S=0,y=s,M=0,g=[];t||(t=[]),M=t.length;for(var w=0;w<M;w++)g.push(s);var R=document.createElement("div");R.style.cssText="position:fixed;top:0;left:0;opacity:0.9;z-index:10000";var T=document.createElement("canvas");T.width=f,T.height=i,R.appendChild(T),T.style.cssText="width:80px;height:48px";var C=T.getContext("2d");C.font="bold "+9*a+"px Helvetica,Arial,sans-serif",C.textBaseline="top",C.fillStyle=h,C.fillRect(0,0,f,i),C.fillStyle=v,C.fillRect(c,d,m,s);var F=function(e,t,n,r){C.fillStyle=e;var o=Math.round((1-n/t)*s);s-a<o?o=s-a:o<0&&(o=0);var f=Math.min(o,r),i=Math.max(o,r)-f;return i<a&&(i=a),C.fillRect(c+m-a,d+f,a,i),o};return{dom:R,getFps:function(){return x},getMs:function(){return S},addCustomGraph:function(e){t.push(e),g.push(s),M++},update:function(e,i,w,R){x=e,S=i,C.fillStyle=h,C.fillRect(0,0,f,d),C.fillStyle=o<=S?"#f08":"#0ff",C.fillText(Math.round(x)+" FPS  -  "+Math.round(S)+" MS",l,u),R&&(C.fillStyle="#fa0",C.fillText(R,l,p)),C.drawImage(T,c+a,d,m-a,s,c,d,m-a,s),C.fillStyle=v,C.fillRect(c+m-a,d,a,s),C.fillStyle="#a15";var z=Math.round((1-x/n)*s);if(z<0&&(z=0),C.fillRect(c+m-a,d+z,a,s-z),y=F("#0ff",r,S,y),M)for(var H=0;H<M;H++)g[H]=F(t[H].color,t[H].max,w[H],g[H])}}};return function(t){var n=t&&t.maxFPS?t.maxFPS:60,r=t&&t.maxMem?t.maxMem:100,o=t&&t.customGraphConf?t.customGraphConf:void 0,a=t&&t.drawInterval?t.drawInterval:1e3,f=!1,i=0,l=(performance||Date).now()+5e3,u=!1;self.performance&&self.performance.memory&&self.performance.memory.usedJSHeapSize&&(f=!0,i=self.performance.memory.usedJSHeapSize);var c=new e(n,o),d=(performance||Date).now(),m=d,s=0,p=0,h=0,v="";return{dom:c.dom,getFps:function(){return c.getFps()},getMs:function(){return c.getMs()},getMem:function(){return p},setText:function(e){v=e},begin:function(){d=(performance||Date).now()},end:function(e){s++;var t=(performance||Date).now(),n=t-d;if(h<n&&(h=n),t>=m+a){var o=v;f&&(console.log("TEST"),i!==performance.memory.usedJSHeapSize?(f=!1,c.addCustomGraph({color:"#fa0",max:r}),u=!0):l<t&&(f=!1)),u&&(e||(e=[]),p=window.performance.memory.usedJSHeapSize/1048576,e.push(p),o=Math.round(p)+" MB  "+v),c.update(1e3*s/(t-m),h,e,o),m=t,s=0,h=0}return t},update:function(e){d=this.end(e)}}}});